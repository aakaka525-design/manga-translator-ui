# v1.9.3 更新日志

发布日期：2025-12-07

## 🎉 新功能

### Web UI 管理系统重构
- **完整的管理后台**：重写了 Web UI，提供完整的管理系统
- **用户管理**：支持用户注册、登录、权限管理
- **任务管理**：实时查看和管理翻译任务
- **系统配置**：通过 Web 界面配置翻译参数

### Qt UI 新功能
- **环境变量预设**：新增 `.env` 预设功能，可快速切换不同的 API 配置
- **PDF/CBZ 支持**：支持直接导入 PDF 和 CBZ 格式的漫画文件

### 高质量翻译器增强
- **辅助框翻译**：高质量翻译器添加了辅助框功能，显著提升翻译效果
- 更好的上下文理解和翻译一致性

## ⚡ 优化

### OpenAI 接口优化
- **LM Studio 支持**：优化了 OpenAI 兼容接口，现已支持 LM Studio 本地部署
- **超时时间提升**：提高了翻译器的超时时间，避免大批量翻译时超时失败

### 编辑器稳定性优化
- **异常处理增强**：为关键操作添加了完善的异常处理，防止崩溃
- **空引用保护**：增加了对已删除对象的安全检查
- **竞态条件修复**：修复了异步操作和 UI 更新之间的竞态问题

### 内存管理优化
- **多文件切换优化**：改进图片缓存策略，切换文件时自动释放旧资源
- **导出后内存释放**：导出完成后自动清理临时缓存和 GPU 显存
- **文件卸载优化**：从列表移除文件时完整释放相关内存
- **GPU 显存管理**：关键操作后自动调用 `torch.cuda.empty_cache()`

## 🐛 Bug 修复

### 编辑器
- **修复蒙版编辑无效**：修复了修改蒙版后不生效的问题
- **修复 Item 删除崩溃**：修复了删除区域时可能导致的崩溃
- **修复选择同步问题**：修复了模型选择状态与 UI 不同步的问题

---

## 升级说明

### 环境变量预设使用方法
1. 在 Qt UI 中点击"预设"下拉框
2. 选择或创建新的预设配置
3. 预设会保存 API Key、模型选择等环境变量

### LM Studio 配置
1. 启动 LM Studio 并加载模型
2. 在翻译器设置中选择 OpenAI 兼容接口
3. 将 API 地址设置为 `http://localhost:1234/v1`
